Sat 30 Jan 2021 22:14:14 INFO General Hyper Parameters: 
gpu_id=0
use_gpu=True
seed=2020
state=INFO
reproducibility=True
data_path=data\mind_small_dev
show_progress=True

Training Hyper Parameters: 
checkpoint_dir=saved
epochs=10
train_batch_size=2048
learner=adam
learning_rate=0.001
training_neg_sample_num=1
training_neg_sample_distribution=uniform
eval_step=1
stopping_step=10

Evaluation Hyper Parameters: 
eval_setting=RO_RS,full
group_by_user=True
split_ratio=[0.8, 0.1, 0.1]
leave_one_num=2
real_time_process=False
metrics=['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk=[10]
valid_metric=MRR@10
eval_batch_size=4096

Dataset Hyper Parameters: 
field_separator=	
seq_separator= 
USER_ID_FIELD=user_id
ITEM_ID_FIELD=item_id
RATING_FIELD=rating
TIME_FIELD=timestamp
seq_len=None
LABEL_FIELD=label
threshold=None
NEG_PREFIX=neg_
load_col={'inter': ['user_id', 'item_id']}
unload_col=None
unused_col=None
additional_feat_suffix=None
lowest_val=None
highest_val=None
equal_val=None
not_equal_val=None
max_user_inter_num=None
min_user_inter_num=0
max_item_inter_num=None
min_item_inter_num=0
fields_in_same_space=None
preload_weight=None
normalize_field=None
normalize_all=None
ITEM_LIST_LENGTH_FIELD=item_length
LIST_SUFFIX=_list
MAX_ITEM_LIST_LENGTH=50
POSITION_FIELD=position_id
HEAD_ENTITY_ID_FIELD=head_id
TAIL_ENTITY_ID_FIELD=tail_id
RELATION_ID_FIELD=relation_id
ENTITY_ID_FIELD=entity_id


Sat 30 Jan 2021 22:14:17 INFO mind_small_dev
The number of users: 50001
Average actions of users: 54.81996
The number of items: 5370
Average actions of items: 510.5230024213075
The number of inters: 2740998
The sparsity of the dataset: 98.97916455078719%
Remain Fields: ['user_id', 'item_id']
Sat 30 Jan 2021 22:14:24 INFO Build [ModelType.GENERAL] DataLoader for [train] with format [InputType.PAIRWISE]
Sat 30 Jan 2021 22:14:24 INFO Evaluation Setting:
	Group by user_id
	Ordering: {'strategy': 'shuffle'}
	Splitting: {'strategy': 'by_ratio', 'ratios': [0.8, 0.1, 0.1]}
	Negative Sampling: {'strategy': 'by', 'distribution': 'uniform', 'by': 1}
Sat 30 Jan 2021 22:14:24 INFO batch_size = [[2048]], shuffle = [True]

Sat 30 Jan 2021 22:14:24 INFO Build [ModelType.GENERAL] DataLoader for [evaluation] with format [InputType.POINTWISE]
Sat 30 Jan 2021 22:14:24 INFO Evaluation Setting:
	Group by user_id
	Ordering: {'strategy': 'shuffle'}
	Splitting: {'strategy': 'by_ratio', 'ratios': [0.8, 0.1, 0.1]}
	Negative Sampling: {'strategy': 'full', 'distribution': 'uniform'}
Sat 30 Jan 2021 22:14:24 INFO batch_size = [[4096, 4096]], shuffle = [False]

Sat 30 Jan 2021 22:14:26 WARNING Batch size is changed to 5370.
Sat 30 Jan 2021 22:14:28 WARNING Batch size is changed to 5370.
Sat 30 Jan 2021 22:14:28 INFO BPR(
  (user_embedding): Embedding(50001, 64)
  (item_embedding): Embedding(5370, 64)
  (loss): BPRLoss()
)
Trainable parameters: 3543744
Sat 30 Jan 2021 22:15:23 INFO epoch 0 training [time: 55.28s, train loss:268.6712]
Sat 30 Jan 2021 22:15:53 INFO epoch 0 evaluating [time: 29.65s, valid_score: 0.382500]
Sat 30 Jan 2021 22:15:53 INFO valid result: 
recall@10 : 0.3225    mrr@10 : 0.3825    ndcg@10 : 0.2737    hit@10 : 0.6847    precision@10 : 0.1336    
Sat 30 Jan 2021 22:15:53 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:16:48 INFO epoch 1 training [time: 55.42s, train loss:82.8628]
Sat 30 Jan 2021 22:17:19 INFO epoch 1 evaluating [time: 30.05s, valid_score: 0.401300]
Sat 30 Jan 2021 22:17:19 INFO valid result: 
recall@10 : 0.3244    mrr@10 : 0.4013    ndcg@10 : 0.2797    hit@10 : 0.6925    precision@10 : 0.1389    
Sat 30 Jan 2021 22:17:19 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:18:22 INFO epoch 2 training [time: 63.27s, train loss:72.1467]
Sat 30 Jan 2021 22:18:51 INFO epoch 2 evaluating [time: 29.56s, valid_score: 0.432100]
Sat 30 Jan 2021 22:18:51 INFO valid result: 
recall@10 : 0.3467    mrr@10 : 0.4321    ndcg@10 : 0.301    hit@10 : 0.7196    precision@10 : 0.1504    
Sat 30 Jan 2021 22:18:51 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:19:46 INFO epoch 3 training [time: 55.04s, train loss:63.9820]
Sat 30 Jan 2021 22:20:16 INFO epoch 3 evaluating [time: 29.16s, valid_score: 0.473200]
Sat 30 Jan 2021 22:20:16 INFO valid result: 
recall@10 : 0.3738    mrr@10 : 0.4732    ndcg@10 : 0.3318    hit@10 : 0.7516    precision@10 : 0.1623    
Sat 30 Jan 2021 22:20:16 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:21:11 INFO epoch 4 training [time: 54.96s, train loss:57.7393]
Sat 30 Jan 2021 22:21:40 INFO epoch 4 evaluating [time: 29.43s, valid_score: 0.496800]
Sat 30 Jan 2021 22:21:40 INFO valid result: 
recall@10 : 0.3998    mrr@10 : 0.4968    ndcg@10 : 0.3544    hit@10 : 0.7787    precision@10 : 0.1727    
Sat 30 Jan 2021 22:21:40 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:22:35 INFO epoch 5 training [time: 55.01s, train loss:53.3295]
Sat 30 Jan 2021 22:23:04 INFO epoch 5 evaluating [time: 29.04s, valid_score: 0.508700]
Sat 30 Jan 2021 22:23:04 INFO valid result: 
recall@10 : 0.4218    mrr@10 : 0.5087    ndcg@10 : 0.3696    hit@10 : 0.8022    precision@10 : 0.1814    
Sat 30 Jan 2021 22:23:04 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:24:06 INFO epoch 6 training [time: 61.49s, train loss:49.5689]
Sat 30 Jan 2021 22:24:36 INFO epoch 6 evaluating [time: 30.75s, valid_score: 0.522800]
Sat 30 Jan 2021 22:24:36 INFO valid result: 
recall@10 : 0.4354    mrr@10 : 0.5228    ndcg@10 : 0.3842    hit@10 : 0.8166    precision@10 : 0.1877    
Sat 30 Jan 2021 22:24:37 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:25:32 INFO epoch 7 training [time: 55.06s, train loss:46.1694]
Sat 30 Jan 2021 22:26:04 INFO epoch 7 evaluating [time: 31.92s, valid_score: 0.545000]
Sat 30 Jan 2021 22:26:04 INFO valid result: 
recall@10 : 0.4516    mrr@10 : 0.545    ndcg@10 : 0.4041    hit@10 : 0.8297    precision@10 : 0.1938    
Sat 30 Jan 2021 22:26:04 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:26:59 INFO epoch 8 training [time: 54.93s, train loss:43.7093]
Sat 30 Jan 2021 22:27:30 INFO epoch 8 evaluating [time: 31.41s, valid_score: 0.549600]
Sat 30 Jan 2021 22:27:30 INFO valid result: 
recall@10 : 0.4674    mrr@10 : 0.5496    ndcg@10 : 0.4132    hit@10 : 0.8433    precision@10 : 0.1998    
Sat 30 Jan 2021 22:27:30 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:28:24 INFO epoch 9 training [time: 54.47s, train loss:40.9170]
Sat 30 Jan 2021 22:28:53 INFO epoch 9 evaluating [time: 28.95s, valid_score: 0.561100]
Sat 30 Jan 2021 22:28:53 INFO valid result: 
recall@10 : 0.4807    mrr@10 : 0.5611    ndcg@10 : 0.4264    hit@10 : 0.8533    precision@10 : 0.2044    
Sat 30 Jan 2021 22:28:53 INFO Saving current best: saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:28:53 INFO Loading model structure and parameters from saved\BPR-Jan-30-2021_22-14-28.pth
Sat 30 Jan 2021 22:29:23 INFO best valid result: {'recall@10': 0.4807, 'mrr@10': 0.5611, 'ndcg@10': 0.4264, 'hit@10': 0.8533, 'precision@10': 0.2044}
Sat 30 Jan 2021 22:29:23 INFO test result: {'recall@10': 0.5052, 'mrr@10': 0.6484, 'ndcg@10': 0.4816, 'hit@10': 0.866, 'precision@10': 0.2239}
