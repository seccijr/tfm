Sat 30 Jan 2021 23:27:56 INFO General Hyper Parameters: 
gpu_id=0
use_gpu=True
seed=2020
state=INFO
reproducibility=True
data_path=data\mind_small_positive
show_progress=True

Training Hyper Parameters: 
checkpoint_dir=saved
epochs=10
train_batch_size=2048
learner=adam
learning_rate=0.001
training_neg_sample_num=1
training_neg_sample_distribution=uniform
eval_step=1
stopping_step=10

Evaluation Hyper Parameters: 
eval_setting=RO_RS,full
group_by_user=True
split_ratio=[0.8, 0.1, 0.1]
leave_one_num=2
real_time_process=False
metrics=['Recall', 'MRR', 'NDCG', 'Hit', 'Precision']
topk=[10]
valid_metric=MRR@10
eval_batch_size=4096

Dataset Hyper Parameters: 
field_separator=	
seq_separator= 
USER_ID_FIELD=user_id
ITEM_ID_FIELD=item_id
RATING_FIELD=rating
TIME_FIELD=timestamp
seq_len=None
LABEL_FIELD=label
threshold=None
NEG_PREFIX=neg_
load_col={'inter': ['user_id', 'item_id']}
unload_col=None
unused_col=None
additional_feat_suffix=None
lowest_val=None
highest_val=None
equal_val=None
not_equal_val=None
max_user_inter_num=None
min_user_inter_num=0
max_item_inter_num=None
min_item_inter_num=0
fields_in_same_space=None
preload_weight=None
normalize_field=None
normalize_all=None
ITEM_LIST_LENGTH_FIELD=item_length
LIST_SUFFIX=_list
MAX_ITEM_LIST_LENGTH=50
POSITION_FIELD=position_id
HEAD_ENTITY_ID_FIELD=head_id
TAIL_ENTITY_ID_FIELD=tail_id
RELATION_ID_FIELD=relation_id
ENTITY_ID_FIELD=entity_id


Sat 30 Jan 2021 23:27:57 INFO mind_small_positive
The number of users: 50001
Average actions of users: 2.22766
The number of items: 2213
Average actions of items: 50.353978300180835
The number of inters: 111383
The sparsity of the dataset: 99.89933956404468%
Remain Fields: ['user_id', 'item_id']
Sat 30 Jan 2021 23:27:59 INFO Build [ModelType.GENERAL] DataLoader for [train] with format [InputType.PAIRWISE]
Sat 30 Jan 2021 23:27:59 INFO Evaluation Setting:
	Group by user_id
	Ordering: {'strategy': 'shuffle'}
	Splitting: {'strategy': 'by_ratio', 'ratios': [0.8, 0.1, 0.1]}
	Negative Sampling: {'strategy': 'by', 'distribution': 'uniform', 'by': 1}
Sat 30 Jan 2021 23:27:59 INFO batch_size = [[2048]], shuffle = [True]

Sat 30 Jan 2021 23:27:59 INFO Build [ModelType.GENERAL] DataLoader for [evaluation] with format [InputType.POINTWISE]
Sat 30 Jan 2021 23:27:59 INFO Evaluation Setting:
	Group by user_id
	Ordering: {'strategy': 'shuffle'}
	Splitting: {'strategy': 'by_ratio', 'ratios': [0.8, 0.1, 0.1]}
	Negative Sampling: {'strategy': 'full', 'distribution': 'uniform'}
Sat 30 Jan 2021 23:27:59 INFO batch_size = [[4096, 4096]], shuffle = [False]

Sat 30 Jan 2021 23:27:59 INFO BPR(
  (user_embedding): Embedding(50001, 64)
  (item_embedding): Embedding(2213, 64)
  (loss): BPRLoss()
)
Trainable parameters: 3341696
Sat 30 Jan 2021 23:28:01 INFO epoch 0 training [time: 2.30s, train loss:37.4277]
Sat 30 Jan 2021 23:28:01 INFO epoch 0 evaluating [time: 0.34s, valid_score: 0.007200]
Sat 30 Jan 2021 23:28:01 INFO valid result: 
recall@10 : 0.0235    mrr@10 : 0.0072    ndcg@10 : 0.0109    hit@10 : 0.0242    precision@10 : 0.0024    
Sat 30 Jan 2021 23:28:01 INFO Saving current best: saved\BPR-Jan-30-2021_23-27-59.pth
Sat 30 Jan 2021 23:28:04 INFO epoch 1 training [time: 2.45s, train loss:37.1171]
Sat 30 Jan 2021 23:28:04 INFO epoch 1 evaluating [time: 0.63s, valid_score: 0.075700]
Sat 30 Jan 2021 23:28:04 INFO valid result: 
recall@10 : 0.1928    mrr@10 : 0.0757    ndcg@10 : 0.1021    hit@10 : 0.2    precision@10 : 0.0201    
Sat 30 Jan 2021 23:28:05 INFO Saving current best: saved\BPR-Jan-30-2021_23-27-59.pth
Sat 30 Jan 2021 23:28:08 INFO epoch 2 training [time: 3.00s, train loss:35.5250]
Sat 30 Jan 2021 23:28:08 INFO epoch 2 evaluating [time: 0.61s, valid_score: 0.086400]
Sat 30 Jan 2021 23:28:08 INFO valid result: 
recall@10 : 0.2177    mrr@10 : 0.0864    ndcg@10 : 0.1162    hit@10 : 0.2242    precision@10 : 0.0228    
Sat 30 Jan 2021 23:28:08 INFO Saving current best: saved\BPR-Jan-30-2021_23-27-59.pth
Sat 30 Jan 2021 23:28:11 INFO epoch 3 training [time: 2.88s, train loss:31.1111]
Sat 30 Jan 2021 23:28:12 INFO epoch 3 evaluating [time: 0.61s, valid_score: 0.088700]
Sat 30 Jan 2021 23:28:12 INFO valid result: 
recall@10 : 0.219    mrr@10 : 0.0887    ndcg@10 : 0.1179    hit@10 : 0.2268    precision@10 : 0.0228    
Sat 30 Jan 2021 23:28:12 INFO Saving current best: saved\BPR-Jan-30-2021_23-27-59.pth
Sat 30 Jan 2021 23:28:15 INFO epoch 4 training [time: 2.93s, train loss:24.4883]
Sat 30 Jan 2021 23:28:15 INFO epoch 4 evaluating [time: 0.64s, valid_score: 0.085200]
Sat 30 Jan 2021 23:28:15 INFO valid result: 
recall@10 : 0.2112    mrr@10 : 0.0852    ndcg@10 : 0.1134    hit@10 : 0.2174    precision@10 : 0.0219    
Sat 30 Jan 2021 23:28:18 INFO epoch 5 training [time: 2.83s, train loss:18.2390]
Sat 30 Jan 2021 23:28:19 INFO epoch 5 evaluating [time: 0.63s, valid_score: 0.083700]
Sat 30 Jan 2021 23:28:19 INFO valid result: 
recall@10 : 0.2112    mrr@10 : 0.0837    ndcg@10 : 0.1124    hit@10 : 0.2174    precision@10 : 0.0219    
Sat 30 Jan 2021 23:28:22 INFO epoch 6 training [time: 2.83s, train loss:13.8120]
Sat 30 Jan 2021 23:28:22 INFO epoch 6 evaluating [time: 0.58s, valid_score: 0.083300]
Sat 30 Jan 2021 23:28:22 INFO valid result: 
recall@10 : 0.2092    mrr@10 : 0.0833    ndcg@10 : 0.1117    hit@10 : 0.2148    precision@10 : 0.0216    
Sat 30 Jan 2021 23:28:25 INFO epoch 7 training [time: 2.83s, train loss:10.9935]
Sat 30 Jan 2021 23:28:26 INFO epoch 7 evaluating [time: 0.60s, valid_score: 0.081900]
Sat 30 Jan 2021 23:28:26 INFO valid result: 
recall@10 : 0.2145    mrr@10 : 0.0819    ndcg@10 : 0.1115    hit@10 : 0.2215    precision@10 : 0.0223    
Sat 30 Jan 2021 23:28:28 INFO epoch 8 training [time: 2.82s, train loss:9.2480]
Sat 30 Jan 2021 23:28:29 INFO epoch 8 evaluating [time: 0.60s, valid_score: 0.081200]
Sat 30 Jan 2021 23:28:29 INFO valid result: 
recall@10 : 0.2172    mrr@10 : 0.0812    ndcg@10 : 0.1117    hit@10 : 0.2228    precision@10 : 0.0224    
Sat 30 Jan 2021 23:28:32 INFO epoch 9 training [time: 2.85s, train loss:8.0077]
Sat 30 Jan 2021 23:28:33 INFO epoch 9 evaluating [time: 0.60s, valid_score: 0.081700]
Sat 30 Jan 2021 23:28:33 INFO valid result: 
recall@10 : 0.2186    mrr@10 : 0.0817    ndcg@10 : 0.1125    hit@10 : 0.2242    precision@10 : 0.0226    
Sat 30 Jan 2021 23:28:33 INFO Loading model structure and parameters from saved\BPR-Jan-30-2021_23-27-59.pth
Sat 30 Jan 2021 23:28:33 INFO best valid result: {'recall@10': 0.219, 'mrr@10': 0.0887, 'ndcg@10': 0.1179, 'hit@10': 0.2268, 'precision@10': 0.0228}
Sat 30 Jan 2021 23:28:33 INFO test result: {'recall@10': 0.1975, 'mrr@10': 0.0819, 'ndcg@10': 0.1079, 'hit@10': 0.2054, 'precision@10': 0.0205}
